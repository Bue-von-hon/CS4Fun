# 데이터 베이스

<details>
<summary>키</summary>
<div>

슈퍼키 : 유일성을 갖춘 키, 각 레코드를 식벽할 수 있음

후보키 : 기본키가 될 수 있는 애들

기본키 : 프라이머리 키, 유일성과 최소성 만족, 널 안됌

대체키 : 후보키가 여러개이면 기본키 외에 다른 키들

외래키 : 다른 테이블의 기본키 참조한 것

복합키 : 여러 필드 섞어서 만든 키

</div>
</details>
<hr>

<details>
<summary>정규화</summary>
<div>

제1 정규화 : 원자값으로 표현하기

제2 정규화 : 부분 함수 종속성 제거, 기본키가 여러 속성으로 구성되었을때, 이중 하나의 속성에 종속되는 것 

제3 정규화 : 이행적 함수 종속성 제거, A -> B, B -> C일때 A -> C

테이블 설계를 잘못하면 이상이 발생할 수 있습니다.

삽입 이상 : 데이터 삽입 시 불필요한 데이터도 함께 삽입해야함

삭제 이상 : 특정 데이터 삭제시 원하지 않는 데이터 삭제가 발생

수정 이상 : 특정 데이터 업데이트시 다른 행도 함께 수정

</div>
</details>

<hr>
<details>
<summary>트랜잭션</summary>
<div>

<details>
<summary>ACID</summary>
<div>

A : 원자성, all | nothing

C : 일관성, 트랜잭션 이후에도 db상태 동일, 송금 전후로 금액 등의 타입이 같음

I : 격리성, 트랜잭션 사이에 다른 트랜잭션 껴들면 안됌

D : 지속성, 커밋 이후 이를 기록하여 저장

</div>
</details>

<details>
<summary>고립수준</summary>
<div>

고립수준이 지켜지지 않으면 아래와 같은 문제가 발생할 수 있습니다.

dirty read : 

none-repeatable read : 읽기 요청 이후 또 읽기 요청을 하면 이전과 결과가 달라짐 

phantom read : 이전에 없던 내용이 읽혀짐

고립 수준은 아래와 같습니다.

uncommitted read : 커밋이 안된 내용을 읽습니다. 위 3가지 단점 모두가 발생합니다.

committed read : 커밋이 된 내용만을 읽습니다. none-repeatable read, phantom read 문제가 발생합니다.

repeatable read : phantom read가 발생 가능합니다.

serialize : 모든 단점이 없습니다.

</div>
</details>

</div>
</details>
<hr>

<details>
<summary>인덱스</summary>
<div>

인덱스는 검색을 빠르게 도와줍니다.
보통 B+트리를 이용해 구현합니다.

인덱스는 자동으로 생성되는 애랑 직접 만들어주는 인덱스 2가지가 있습니다.

흔히 말하는 클러스터, 논-클러스터는 자동으로 만들어집니다.(unique 등의 키워드로 생성됩니다. 완전 자동은 아닙니다ㅎㅎ)

클러스터형은 따로 인덱스 테이블을 만들지 않습니다. PK 기준으로 데이터 테이블 자체를 그냥 씁니다. 예상대로 삽입,삭제 등이 발생하면 재정렬합니다.

논-클러스터는 인덱스용 테이블이 있습니다. 데이터 테이블을 정렬하는게 인덱스 테이블만 정렬합니다.(당연한거죠 이미 클러스터가 정렬했으니...) 

직접 만드는 인덱스는 create 키워드를 이용해 직접 만듭니다.

한개 이상의 컬럼을 엮어 인덱스를 만들 수 있고, 새로운 인덱스 테이블이 생성됩니다.

보통은 디비가 알아서 최적의 인덱스를 골라 쿼리를 실행하지만, 힌트를 이용해 커스텀도 가능합니다.

</div>
</details>
<hr>
<details>
<summary>조인</summary>
<div>

대표적으로 이너 조인가 아우터 조인등이 있습니다.

겹치는 영역만 가져오기 혹은 겹치지 않은 곳 중 어디를 가져올지에 따라서 종류가 다양합니다.

이러한 조인은 nested loop, hash, merge sort 등을 이용해 구현합니다.

두개의 테이블을 서로 조인한다고 가정하면 각각 다음과 같은 방식으로 동작합니다.

nested loop : 이중포문으로 조인

hash : 테이블 한개를 해쉬테이블에 쭉 올려두고 나머지 테이블 조인, == 요런 친구들 조인합니다.

merge sort : 조인할 필그 기준으로 정렬 다음으로 정렬한 필드값을 기준으로 조인, >, < 이런 친구들 조인합니다. 

</div>
</details>

